def train_model(model, X_train, y_train, batch_size):
callbacks = [ EarlyStopping(patience=8, monitor='val_mae', restore_best_weights=True),
 ReduceLROnPlateau(monitor='val_mae', factor=0.5, patience=4)
 ]
 history = model.fit(X_train, y_train, epochs=150, batch_size=batch_size,
validation_split=0.2, callbacks=callbacks, verbose=1) return history 